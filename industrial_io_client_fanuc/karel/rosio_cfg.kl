
-- Copyright (c) 2017, TU Delft Robotics Institute
--
-- Licensed under the Apache License, Version 2.0 (the "License");
-- you may not use this file except in compliance with the License.
-- You may obtain a copy of the License at
--
--     http://www.apache.org/licenses/LICENSE-2.0
--
-- Unless required by applicable law or agreed to in writing, software
-- distributed under the License is distributed on an "AS IS" BASIS,
-- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-- See the License for the specific language governing permissions and
-- limitations under the License.


PROGRAM rosio_cfg
--------------------------------------------------------------------------------
--
-- ROS-Industrial configuration setup program - ROS_IO.
--
-- NOTE: this program will configure ROS_IO with its DEFAULT SETTINGS.
--
--
--------------------------------------------------------------------------------
%ALPHABETIZE
%COMMENT = 'ROS//r3b'
%NOLOCKGROUP
%NOPAUSE = COMMAND + TPENABLE + ERROR




--------------------------------------------------------------------------------
--
-- remote types & constants
--
--------------------------------------------------------------------------------
%INCLUDE include\libio_pkt_t




--------------------------------------------------------------------------------
--
-- local types & constants
--
--------------------------------------------------------------------------------
CONST
	PROG_NAME    = 'ROS_IO'

	FILE_ILL_PRM =  2032 -- FILE-032 Illegal parameter
	SEV_ABORT    =    2  -- ABORT severity

	-- config defaults
	TAG_NR       =    5  -- Server tag
	TCP_PORT     = RI_TCP_IO

	LOOP_HZ      =  40




--------------------------------------------------------------------------------
--
-- local variables
--
--------------------------------------------------------------------------------
VAR
	stat_        : INTEGER




--------------------------------------------------------------------------------
--
-- remote routine prototypes
--
--------------------------------------------------------------------------------




--------------------------------------------------------------------------------
--
-- local routine prototypes
--
--------------------------------------------------------------------------------




--------------------------------------------------------------------------------
--
-- Main program
--
--------------------------------------------------------------------------------
BEGIN
	stat_ = 0

	-- set all settings to their defaults

	SET_VAR(0, PROG_NAME, 'cfg_.checked', FALSE, stat_)
	IF (stat_ <> 0) THEN POST_ERR(FILE_ILL_PRM, '', 0, SEV_ABORT); ENDIF

	SET_VAR(0, PROG_NAME, 'cfg_.loop_hz', LOOP_HZ, stat_)
	IF (stat_ <> 0) THEN POST_ERR(FILE_ILL_PRM, '', 0, SEV_ABORT); ENDIF

	SET_VAR(0, PROG_NAME, 'cfg_.s_tag_nr', TAG_NR, stat_)
	IF (stat_ <> 0) THEN POST_ERR(FILE_ILL_PRM, '', 0, SEV_ABORT); ENDIF

	SET_VAR(0, PROG_NAME, 'cfg_.s_tcp_nr', TCP_PORT, stat_)
	IF (stat_ <> 0) THEN POST_ERR(FILE_ILL_PRM, '', 0, SEV_ABORT); ENDIF

	SET_VAR(0, PROG_NAME, 'cfg_.um_clear', FALSE, stat_)
	IF (stat_ <> 0) THEN POST_ERR(FILE_ILL_PRM, '', 0, SEV_ABORT); ENDIF

END rosio_cfg
